<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VASCO PARAÍBA JOGOS</title>

  <style>
    :root {
      --muted: rgba(255,255,255,0.75);
      --gold: #ffd700;
      --gold-bright: #ffea00;
    }

    html,body {
      height:100%;
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Arial;
      background:#000;
      color:#fff;
    }

    body::before {
      content:'';
      position:fixed;
      inset:0;
      background-image:url('baixados.jpg');
      background-size:cover;
      background-position:center;
      opacity:0.15;
      z-index:0;
      pointer-events:none;
      filter:contrast(.9) saturate(.6);
    }

    header {
      position:relative;
      z-index:2;
      padding:28px 16px;
      text-align:center;
      background:linear-gradient(180deg,rgba(0,0,0,.6),rgba(0,0,0,.15));
    }

    .logo { width:140px; display:block; margin:0 auto 8px }
    h1 { margin:0; font-size:2rem; letter-spacing:.04em; text-transform:uppercase }
    .tagline { color:var(--muted); margin-top:6px; font-size:.95rem }

    .container { max-width:980px; margin:20px auto; padding:16px; position:relative; z-index:2 }
    .card { background:rgba(17,17,17,.8); border:1px solid #222; border-radius:12px; padding:18px; margin-bottom:16px; box-shadow:0 8px 30px rgba(0,0,0,.6) }

    table { width:100%; border-collapse:collapse }
    th,td { padding:10px; border-bottom:1px solid rgba(255,255,255,.06); text-align:left; vertical-align:middle; }
    th { color:var(--muted); font-weight:700 }

    tr.next-game {
      background:rgba(255,215,0,0.22);
      font-weight:800 !important;
      border:2px solid var(--gold);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { box-shadow:0 0 6px var(--gold-bright); }
      50% { box-shadow:0 0 20px var(--gold); }
      100% { box-shadow:0 0 6px var(--gold-bright); }
    }

    .small { color:var(--muted); font-size:.95rem }
    .rsvp { display:flex; gap:12px; flex-wrap:wrap; align-items:flex-start }
    input[type=text] {
      width:100%; padding:10px; border-radius:8px;
      border:1px solid #333; background:#0f0f0f; color:#fff;
    }

    .btn {
      padding:10px 14px; border-radius:8px;
      border:0; cursor:pointer; font-weight:700;
      transition: all 0.18s ease;
    }
    .btn-primary { background:var(--gold); color:#000 }
    .btn-primary:hover { background:var(--gold-bright); }
    .btn-outline { background:transparent; border:1px solid #fff; color:#fff }
    .btn-outline:hover { background:#fff; color:#000 }

    .pix-note { margin-top:10px; background:rgba(255,255,255,.03); padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,.05) }
    .pix-key { font-weight:900; color:var(--gold); background:rgba(255,215,0,.08); padding:4px 6px; border-radius:6px; display:inline-block }
    .pix-value { font-weight:900; color:#000; background:linear-gradient(90deg,#fff,#ffd700); padding:4px 8px; border-radius:6px; display:inline-block }
    footer { text-align:center; color:var(--muted); margin-top:18px; font-size:.9rem }

    @media (max-width:600px){
      .rsvp{flex-direction:column}
    }
  </style>
</head>
<body>
<header>
  <img src="ícone_Mascote_Zap_PNG.png" alt="Logo Torcida Vasco Paraíba" class="logo">
  <h1>VASCO PARAÍBA JOGOS</h1>
  <div class="tagline">A distância é apenas um detalhe</div>
</header>

<main class="container">

  <section class="card">
    <h2>Próximos jogos</h2>
    <table id="fixture">
      <thead><tr><th>Data</th><th>Confronto</th><th>Competição</th><th>Horário</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <section class="card">
    <h2>Confirmação de Presença</h2>

    <ol class="small">
      <li>Pagamento via PIX para: <span class="pix-key" id="pixKeyText">louisecrvg@gmail.com</span></li>
      <li>Valor por pessoa: <span class="pix-value">R$ 5,00</span></li>
    </ol>

    <div class="rsvp">
      <div style="flex:1">
        <label for="name">Seu nome</label><br>
        <input id="name" type="text" placeholder="Digite seu nome" disabled>
        <div class="pix-note small" id="pixNote">O nome será liberado após o envio do comprovante ✅</div>
      </div>

      <div style="min-width:260px">
        <button id="copyPixBtn" class="btn btn-primary">Copiar chave PIX e pagar</button><br>
        <button id="sendProofBtn" class="btn btn-outline" style="margin-top:10px" disabled>Enviar comprovante (WhatsApp)</button><br>
        <button id="openFormBtn" class="btn btn-outline" style="margin-top:10px" disabled>Clique para colocar o nome</button>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>Contato</h2>
    <p><strong>Torcida Vasco Paraíba</strong><br>
      WhatsApp: (83) 98811-0236<br>
      Email: vascoparaibajogos@gmail.com<br>
      Instagram: @vascoparaiba_</p>
  </section>

  <footer>© 2025 Torcida Vasco Paraíba</footer>
</main>

<script>
/* === CONFIG === */

const fixtures = [
  { date:"08/11/2025", match:"Vasco x Juventude", comp:"Brasileirão", time:"18:00" },
  { date:"19/11/2025", match:"Grêmio x Vasco", comp:"Brasileirão", time:"21:30" },
  { date:"23/11/2025", match:"Bahia x Vasco", comp:"Brasileirão", time:"16:00" },
  { date:"29/11/2025", match:"Vasco x Internacional", comp:"Brasileirão", time:"12:00" },
];

const FORM_BASE = "https://docs.google.com/forms/d/e/1FAIpQLScwwPCBqI0J9-CwwCEfq9qIp8w0_wSkdhakI-NpynXOKTC5Zg/viewform?usp=pp_url";
const ENTRY_NAME = "entry.431602813";
const ENTRY_VALUE = "entry.151240836";
const PIX_KEY = "louisecrvg@gmail.com";
const PIX_VALUE = "R$ 5,00";
const WHATSAPP_PHONE = "5583988110236";

/* === RENDER FIXTURES (remove somente quando iniciar a partida) === */

function parseDateTime(dateStr, timeStr) {
  const [d,m,y] = dateStr.split('/').map(Number);
  if (!timeStr || timeStr.toLowerCase().includes("a definir")) {
    return new Date(y, m-1, d, 23, 59, 59);
  }
  const [h,min] = timeStr.split(':').map(Number);
  return new Date(y, m-1, d, h, min, 0);
}

function renderFixtures() {
  const now = new Date();
  const tbody = document.querySelector("#fixture tbody");
  tbody.innerHTML = "";

  // Mantém somente partidas cujo horário de início ainda NÃO foi atingido (se agora for >= início, consideramos que começou e removemos)
  const futuros = fixtures.filter(f => parseDateTime(f.date, f.time) > now);

  if (!futuros.length) {
    tbody.innerHTML = "<tr><td colspan='4'>Nenhum jogo futuro.</td></tr>";
    return;
  }

  futuros.sort((a,b) => parseDateTime(a.date,a.time) - parseDateTime(b.date,b.time));

  futuros.forEach((f, i) => {
    const tr = document.createElement("tr");
    if (i === 0) tr.classList.add("next-game");
    tr.innerHTML = `<td>${f.date}</td><td>${f.match}</td><td>${f.comp}</td><td>${f.time}</td>`;
    tbody.appendChild(tr);
  });
}

renderFixtures();
setInterval(renderFixtures, 15000);

/* === PIX / COPIAR (com fallback) / WHATSAPP / FORM === */

const copyPixBtn = document.getElementById("copyPixBtn");
const sendProofBtn = document.getElementById("sendProofBtn");
const openFormBtn = document.getElementById("openFormBtn");
const nameInput = document.getElementById("name");
const pixNote = document.getElementById("pixNote");
document.getElementById("pixKeyText").innerText = PIX_KEY;

/* helper: fallback copy (textarea + execCommand) */
function fallbackCopyTextToClipboard(text) {
  return new Promise((resolve, reject) => {
    try {
      const textarea = document.createElement("textarea");
      textarea.value = text;
      // avoid scrolling to bottom
      textarea.style.position = "fixed";
      textarea.style.top = "-9999px";
      document.body.appendChild(textarea);
      textarea.focus();
      textarea.select();
      const successful = document.execCommand('copy');
      document.body.removeChild(textarea);
      if (successful) resolve();
      else reject(new Error('execCommand returned false'));
    } catch (err) {
      reject(err);
    }
  });
}

/* copia de forma robusta */
async function robustCopy(text) {
  if (!text) return Promise.reject(new Error('Texto vazio'));
  // tenta navigator.clipboard primeiro
  try {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      await navigator.clipboard.writeText(text);
      return;
    }
  } catch (e) {
    // ignora e tenta fallback
  }
  // fallback
  return fallbackCopyTextToClipboard(text);
}

/* Ação do botão copiar */
copyPixBtn.addEventListener("click", async () => {
  copyPixBtn.disabled = true;
  const original = copyPixBtn.innerText;
  try {
    await robustCopy(PIX_KEY);
    copyPixBtn.innerText = "Chave PIX copiada!";
    // habilita enviar comprovante
    sendProofBtn.disabled = false;
    pixNote.innerText = "Chave copiada. Agora envie o comprovante no WhatsApp.";
    // opcional: foco no botão enviar comprovante
    setTimeout(()=> sendProofBtn.focus(), 200);
  } catch (err) {
    // se não conseguiu copiar automaticamente, informa e habilita envio para não bloquear o usuário
    copyPixBtn.innerText = "Copiar manualmente";
    sendProofBtn.disabled = false;
    pixNote.innerText = `Não foi possível copiar automaticamente. Copie manualmente: ${PIX_KEY}`;
    setTimeout(()=> copyPixBtn.innerText = original, 3000);
  } finally {
    copyPixBtn.disabled = false;
  }
});

/* Enviar comprovante: abre WhatsApp com mensagem; libera campo nome e botão do form */
sendProofBtn.addEventListener("click", () => {
  const nomeParaMsg = (nameInput.value && nameInput.value.trim()) ? nameInput.value.trim() : "Torcedor";
  const mensagem = `Olá, sou ${nomeParaMsg}. Estou enviando o comprovante do PIX (R$ 5,00) para confirmação de presença.`;
  const url = `https://api.whatsapp.com/send/?phone=${WHATSAPP_PHONE}&text=${encodeURIComponent(mensagem)}&type=phone_number&app_absent=0`;
  window.open(url, "_blank");

  // liberar o campo nome e o botão do formulário logo após o clique
  nameInput.disabled = false;
  openFormBtn.disabled = false;
  // foco no campo nome pra facilitar
  setTimeout(()=> nameInput.focus(), 250);
});

/* Abrir formulário com prefill (nome + valor) */
openFormBtn.addEventListener("click", () => {
  const nome = nameInput.value.trim();
  // monta URL com prefill (FORM_BASE já tem ?usp=pp_url)
  let url = FORM_BASE;
  // se já houver parâmetros (usp), usamos & para adicionar entries
  url += `&${ENTRY_NAME}=${encodeURIComponent(nome)}&${ENTRY_VALUE}=${encodeURIComponent(PIX_VALUE)}`;
  window.open(url, "_blank");
});
</script>
</body>
</html>
